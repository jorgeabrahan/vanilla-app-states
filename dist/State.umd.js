!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e||self).vanillaAppStates={})}(this,function(e){function t(e,t){if(!{}.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var n,r=0;function i(e){return"__private_"+r+++"_"+e}function o(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}var a="undefined"==typeof document?void 0:document,s=!!a&&"content"in a.createElement("template"),u=!!a&&a.createRange&&"createContextualFragment"in a.createRange();function l(e,t){var n,r,i=e.nodeName,o=t.nodeName;return i===o||(n=i.charCodeAt(0),r=o.charCodeAt(0),n<=90&&r>=97?i===o.toUpperCase():r<=90&&n>=97&&o===i.toUpperCase())}function d(e,t,n){e[n]!==t[n]&&(e[n]=t[n],e[n]?e.setAttribute(n,""):e.removeAttribute(n))}var f={OPTION:function(e,t){var n=e.parentNode;if(n){var r=n.nodeName.toUpperCase();"OPTGROUP"===r&&(r=(n=n.parentNode)&&n.nodeName.toUpperCase()),"SELECT"!==r||n.hasAttribute("multiple")||(e.hasAttribute("selected")&&!t.selected&&(e.setAttribute("selected","selected"),e.removeAttribute("selected")),n.selectedIndex=-1)}d(e,t,"selected")},INPUT:function(e,t){d(e,t,"checked"),d(e,t,"disabled"),e.value!==t.value&&(e.value=t.value),t.hasAttribute("value")||e.removeAttribute("value")},TEXTAREA:function(e,t){var n=t.value;e.value!==n&&(e.value=n);var r=e.firstChild;if(r){var i=r.nodeValue;if(i==n||!n&&i==e.placeholder)return;r.nodeValue=n}},SELECT:function(e,t){if(!t.hasAttribute("multiple")){for(var n,r,i=-1,o=0,a=e.firstChild;a;)if("OPTGROUP"===(r=a.nodeName&&a.nodeName.toUpperCase()))a=(n=a).firstChild;else{if("OPTION"===r){if(a.hasAttribute("selected")){i=o;break}o++}!(a=a.nextSibling)&&n&&(a=n.nextSibling,n=null)}e.selectedIndex=i}}};function c(){}function h(e){if(e)return e.getAttribute&&e.getAttribute("id")||e.id}var p=function(e,t,r){if(r||(r={}),"string"==typeof t)if("#document"===e.nodeName||"HTML"===e.nodeName||"BODY"===e.nodeName){var i=t;(t=a.createElement("html")).innerHTML=i}else o=(o=t).trim(),t=s?function(e){var t=a.createElement("template");return t.innerHTML=e,t.content.childNodes[0]}(o):u?function(e){return n||(n=a.createRange()).selectNode(a.body),n.createContextualFragment(e).childNodes[0]}(o):function(e){var t=a.createElement("body");return t.innerHTML=e,t.childNodes[0]}(o);else 11===t.nodeType&&(t=t.firstElementChild);var o,d=r.getNodeKey||h,p=r.onBeforeNodeAdded||c,v=r.onNodeAdded||c,b=r.onBeforeElUpdated||c,m=r.onElUpdated||c,y=r.onBeforeNodeDiscarded||c,g=r.onNodeDiscarded||c,w=r.onBeforeElChildrenUpdated||c,T=r.skipFromChildren||c,N=r.addChild||function(e,t){return e.appendChild(t)},O=!0===r.childrenOnly,A=Object.create(null),C=[];function E(e){C.push(e)}function S(e,t){if(1===e.nodeType)for(var n=e.firstChild;n;){var r=void 0;t&&(r=d(n))?E(r):(g(n),n.firstChild&&S(n,t)),n=n.nextSibling}}function P(e,t,n){!1!==y(e)&&(t&&t.removeChild(e),g(e),S(e,n))}function j(e){v(e);for(var t=e.firstChild;t;){var n=t.nextSibling,r=d(t);if(r){var i=A[r];i&&l(t,i)?(t.parentNode.replaceChild(i,t),x(i,t)):j(t)}else j(t);t=n}}function x(e,t,n){var r=d(t);if(r&&delete A[r],!n){if(!1===b(e,t))return;if(function(e,t){var n,r,i,o,a=t.attributes;if(11!==t.nodeType&&11!==e.nodeType){for(var s=a.length-1;s>=0;s--)r=(n=a[s]).name,o=n.value,(i=n.namespaceURI)?e.getAttributeNS(i,r=n.localName||r)!==o&&("xmlns"===n.prefix&&(r=n.name),e.setAttributeNS(i,r,o)):e.getAttribute(r)!==o&&e.setAttribute(r,o);for(var u=e.attributes,l=u.length-1;l>=0;l--)r=(n=u[l]).name,(i=n.namespaceURI)?t.hasAttributeNS(i,r=n.localName||r)||e.removeAttributeNS(i,r):t.hasAttribute(r)||e.removeAttribute(r)}}(e,t),m(e),!1===w(e,t))return}"TEXTAREA"!==e.nodeName?function(e,t){var n,r,i,o,s,u=T(e,t),c=t.firstChild,h=e.firstChild;e:for(;c;){for(o=c.nextSibling,n=d(c);!u&&h;){if(i=h.nextSibling,c.isSameNode&&c.isSameNode(h)){c=o,h=i;continue e}r=d(h);var v=h.nodeType,b=void 0;if(v===c.nodeType&&(1===v?(n?n!==r&&((s=A[n])?i===s?b=!1:(e.insertBefore(s,h),r?E(r):P(h,e,!0),r=d(h=s)):b=!1):r&&(b=!1),(b=!1!==b&&l(h,c))&&x(h,c)):3!==v&&8!=v||(b=!0,h.nodeValue!==c.nodeValue&&(h.nodeValue=c.nodeValue))),b){c=o,h=i;continue e}r?E(r):P(h,e,!0),h=i}if(n&&(s=A[n])&&l(s,c))u||N(e,s),x(s,c);else{var m=p(c);!1!==m&&(m&&(c=m),c.actualize&&(c=c.actualize(e.ownerDocument||a)),N(e,c),j(c))}c=o,h=i}!function(e,t,n){for(;t;){var r=t.nextSibling;(n=d(t))?E(n):P(t,e,!0),t=r}}(e,h,r);var y=f[e.nodeName];y&&y(e,t)}(e,t):f.TEXTAREA(e,t)}!function e(t){if(1===t.nodeType||11===t.nodeType)for(var n=t.firstChild;n;){var r=d(n);r&&(A[r]=n),e(n),n=n.nextSibling}}(e);var R,U,V=e,k=V.nodeType,I=t.nodeType;if(!O)if(1===k)1===I?l(e,t)||(g(e),V=function(e,t){for(var n=e.firstChild;n;){var r=n.nextSibling;t.appendChild(n),n=r}return t}(e,(R=t.nodeName,(U=t.namespaceURI)&&"http://www.w3.org/1999/xhtml"!==U?a.createElementNS(U,R):a.createElement(R)))):V=t;else if(3===k||8===k){if(I===k)return V.nodeValue!==t.nodeValue&&(V.nodeValue=t.nodeValue),V;V=t}if(V===t)g(e);else{if(t.isSameNode&&t.isSameNode(V))return;if(x(V,t,O),C)for(var M=0,B=C.length;M<B;M++){var L=A[C[M]];L&&P(L,L.parentNode,!1)}}return!O&&V!==e&&e.parentNode&&(V.actualize&&(V=V.actualize(e.ownerDocument||a)),e.parentNode.replaceChild(V,e)),V},v="An error occurred while updating the state in the DOM",b=/*#__PURE__*/i("state"),m=/*#__PURE__*/i("elementsUsingState"),y=/*#__PURE__*/i("renderContentFromOnRender"),g=/*#__PURE__*/i("conditionallyShowElementBasedOnShowIfAttr"),w=/*#__PURE__*/i("conditionallyShowElementBasedOnBooleanState"),T=/*#__PURE__*/i("renderContentFromState"),N=/*#__PURE__*/function(){function e(e){Object.defineProperty(this,T,{value:E}),Object.defineProperty(this,w,{value:C}),Object.defineProperty(this,g,{value:A}),Object.defineProperty(this,y,{value:O}),Object.defineProperty(this,b,{writable:!0,value:void 0}),Object.defineProperty(this,m,{writable:!0,value:void 0}),t(this,b)[b]=e,t(this,m)[m]=Array.from(t(this,b)[b].wrapper.querySelectorAll('[data-state="'+t(this,b)[b].id+'"]'))}return e.prototype.updateElements=function(e){var n=this;t(this,m)[m].forEach(function(r){t(n,b)[b].isUsingOnRender?t(n,y)[y](e,r):null==r.getAttribute("data-show-if")?"boolean"!=typeof e?"string"!=typeof e&&"number"!=typeof e&&"bigint"!=typeof e||t(n,T)[T](e,r):t(n,w)[w](e,r):t(n,g)[g](e,r)})},e}();function O(e,n){var r=t(this,b)[b].onRender(e);if("string"!=typeof r&&(console.error('The "content" to render in the DOM must be a string'),1))return console.error(v);var i=n.cloneNode();i.innerHTML=r,p(n,i)}function A(e,n){var r,i=null!=(r=n.getAttribute("data-show-if"))?r:"";if(!function(e,t){if(!e.isEnum)return console.error('The "data-show-if" attribute is only supported for enum states'),!1;var n=t;return"number"===e.possibleValuesType&&(n=Number(t),isNaN(n))?(console.error('The "data-show-if" attribute must be a number if possible values are numbers'),!1):!!e.possibleValues.includes(n)||(console.error('The "data-show-if" attribute must be one of the possible values of the state'),!1)}(t(this,b)[b],i))return console.error(v);n.style.display=""+e===i?"":"none"}function C(e,t){var n=e?"":"none";t.style.display!==n&&(t.style.display=n)}function E(e,t){if("object"!=typeof e){var n=""+e;t.textContent!==n&&(t.textContent=n)}}var S="An error occurred while creating the state",P=/*#__PURE__*/i("isEnum"),j=/*#__PURE__*/i("possibleValues"),x=/*#__PURE__*/i("possibleValuesType"),R=/*#__PURE__*/i("preserve"),U=/*#__PURE__*/i("id"),V=/*#__PURE__*/i("initial"),k=/*#__PURE__*/i("current"),I=/*#__PURE__*/i("wrapper"),M=/*#__PURE__*/i("isUsingOnRender"),B=/*#__PURE__*/i("domManager"),L=/*#__PURE__*/i("changeState"),D=/*#__PURE__*/function(){function e(e){var n=this,r=e.id,i=e.initial,o=e.wrapper,a=e.onChange,s=e.onRender,u=e.possibleValues,l=e.preserve;Object.defineProperty(this,L,{value:H}),Object.defineProperty(this,P,{writable:!0,value:void 0}),Object.defineProperty(this,j,{writable:!0,value:void 0}),Object.defineProperty(this,x,{writable:!0,value:void 0}),Object.defineProperty(this,R,{writable:!0,value:void 0}),Object.defineProperty(this,U,{writable:!0,value:void 0}),Object.defineProperty(this,V,{writable:!0,value:void 0}),Object.defineProperty(this,k,{writable:!0,value:void 0}),Object.defineProperty(this,I,{writable:!0,value:void 0}),this.onChange=void 0,Object.defineProperty(this,M,{writable:!0,value:void 0}),this.onRender=void 0,Object.defineProperty(this,B,{writable:!0,value:void 0});var d=null!=o?o:document.body;if(!function(e){return"string"!=typeof e?(console.error('The "id" of your state must be of type string'),!1):!(""===e&&(console.error('The "id" of your state must be a non-empty string'),1))}(r))throw new Error(S);if(!function(e){return!!(e instanceof HTMLElement)||(console.error('The "wrapper" of your state must be an instance of HTMLElement'),!1)}(d))throw new Error(S);t(this,U)[U]=r,t(this,V)[V]=i,t(this,R)[R]=null!=l&&l,t(this,I)[I]=d;var f=function(){if(t(n,R)[R]){var e=localStorage.getItem(r);if(null!==e)return JSON.parse(e)}return i}();t(this,k)[k]=f,this.onChange=null!=a?a:function(){},t(this,P)[P]=null!=u,t(this,j)[j]=null!=u?u:[];var c=null!=u?function(e){return e.every(function(e){return"string"==typeof e})?"string":e.every(function(e){return"number"==typeof e})?"number":"unknown"}(u):"unknown";if(t(this,x)[x]=c,null!=u){if(!function(e,t){return e instanceof Array?0===e.length?(console.error('The "possible values" of an enum state must NOT be an empty array'),!1):!("unknown"===t||"string"!==t&&"number"!==t)||(console.error('The "possible values" of an enum state must be an array of strings or numbers'),!1):(console.error('The "possible values" of an enum state must be an array'),!1)}(u,c))throw new Error(S);if(!function(e,t){return!(typeof e!==t&&(console.error('The "initial value" of your enum state must be a '+t),1))}(i,c))throw new Error(S)}t(this,M)[M]=null!=s,this.onRender=null!=s?s:function(){return""},t(this,B)[B]=new N(this),t(this,B)[B].updateElements(f),t(this,R)[R]&&this.onChange(f,i)}var n,r,i=e.prototype;return i.update=function(e){if(t(this,P)[P]&&!function(e,t,n){return typeof e!==n?(console.error('The "state" of your enum state must be a '+n),!1):!!t.includes(e)||(console.error('The "state" of your enum state must be one of the possible values'),!1)}(e,t(this,j)[j],t(this,x)[x]))return console.error("An error occurred while updating the state");t(this,B)[B].updateElements(e),t(this,L)[L](e),t(this,R)[R]&&localStorage.setItem(t(this,U)[U],JSON.stringify(e))},i.reset=function(){t(this,B)[B].updateElements(t(this,V)[V]),t(this,L)[L](t(this,V)[V]),t(this,R)[R]&&localStorage.removeItem(t(this,U)[U])},n=e,(r=[{key:"id",get:function(){return t(this,U)[U]}},{key:"current",get:function(){return t(this,k)[k]}},{key:"isUsingOnRender",get:function(){return t(this,M)[M]}},{key:"isEnum",get:function(){return t(this,P)[P]}},{key:"possibleValues",get:function(){return t(this,j)[j]}},{key:"possibleValuesType",get:function(){return t(this,x)[x]}},{key:"wrapper",get:function(){return t(this,I)[I]}}])&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,o(r.key),r)}}(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n}();function H(e){var n=t(this,k)[k];t(this,k)[k]=e,this.onChange(e,n)}e.State=D});
//# sourceMappingURL=State.umd.js.map
